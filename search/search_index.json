{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Sobre o projeto","text":"<p>Bem vindo \u00e1 documenta\u00e7\u00e3o do Sabores da Terra, uma loja online de produtos org\u00e2nicos regionais.</p>"},{"location":"#pagina-web","title":"Pagina Web","text":"<p>A pagina web \u00e9 a principal interface para o uso e o gerencianto da loja.</p> <ul> <li>Posui uma pagina de registro e login de clientes.</li> <li>Possui uma home page com os principais produtos e uma barra de pesquisa para encontrar o produto desejado.</li> <li>Cada produto possui sua propria pagina com todas as suas informa\u00e7\u00f5es e um bot\u00e3o para adicionar o produto no carrinho de compras.</li> <li>O carrinho de compras mostra todos os items do pedido do cliente. Com a possibilidade de alterar items como desejar.</li> <li>O bot\u00e3o de compra redireciona o cliente para um sistema de pagamento externo.</li> <li>Um painel administrativo permite o admin, criar produtos, visualizar dados dos clientes e dos pedidos.</li> </ul>"},{"location":"#login-e-cadastro","title":"Login e Cadastro","text":""},{"location":"#home-page","title":"Home Page","text":""},{"location":"#product-page","title":"Product Page","text":""},{"location":"#meu-perfil","title":"Meu perfil","text":""},{"location":"#carrinho-de-compras","title":"Carrinho de compras","text":""},{"location":"#painel-do-admin","title":"Painel do Admin","text":""},{"location":"#api","title":"API","text":"<p>Sabores da Terra possui uma api moderna, desenvolvida com FastAPI.</p> <ul> <li>Possui gest\u00e3o de clientes com Resgisto, altera\u00e7\u00e3o dos dados pessoais e exclus\u00e3o de conta.</li> <li>Sistema seguro de autentica\u00e7\u00e3o baseado em tokens JWT.</li> <li>Possui 2 tipos de usuarios: comum e admin</li> <li>Getao de produtos pelo Admin: Cadastro de produtos para a venda, controle de estoque e altera\u00e7ao de pre\u00e7os, nome e descri\u00e7\u00e3o.</li> <li>Cria\u00e7\u00e3o de Pedidos: Os clientes podem comprar varios produtos de uma vez, remover ou alterar a quantidade dos produtos individualmente a qualquer momento.</li> <li>Enpoints recebem e retornan Json, serializado e validado por contratos do Pydantic.</li> </ul>"},{"location":"#bot-de-telegram-sabores_da_terra_bot","title":"Bot de Telegram - @Sabores_da_terra_bot","text":"<p>O bot de telegram permite qualquer pessoa sem login, visualizar os produtos em tempo real.</p> <ul> <li>O bot possui uma interface de utiliza\u00e7\u00e3o simples atravez de comandos. Por exemplo /menu.</li> <li>Tambem possui links de redirecionamento para a pagina web e para as redes socias da loja.</li> </ul> <p></p>"},{"location":"auth/","title":"Autentica\u00e7\u00e3o","text":"<p>O Sabores da Terra possui autentifica\u00e7\u00e3o via backend, usando a estrat\u00e9gia do token JWT.</p> <p>A cria\u00e7\u00e3o do token possui 2 fases:</p> <ul> <li>A partir do preenchimento do OAuth form com email e password, o token \u00e9 criado e salvo em um cookie com a key access_token.</li> <li>Tamb\u00e9m \u00e9 retornado no body da requisi\u00e7\u00e3o via Bearer token.</li> </ul> <p>\u00c9 possivel fazer o transporte do token e 2 formas diferentes:</p> <ul> <li> <p>Bearer:</p> <ul> <li>O token deve ser enviado no header da requisi\u00e7\u00e3o: Authorization: bearer seu_token.</li> </ul> </li> <li> <p>Cookie:</p> <ul> <li>O navegador envia o cookie automaticamente nas rotas onde \u00e9 necessaria a autentica\u00e7\u00e3o.</li> </ul> </li> </ul>"},{"location":"auth/#autorizacao","title":"Autoriza\u00e7\u00e3o","text":"<p>Existe 3 niveis de Autoriza\u00e7\u00e3o no Sabores da terra:</p> <ul> <li> <p>Usuario sem login:</p> <ul> <li>Pode acessar a home page do site e a pagina dos produtos qua est\u00e3o a venda.</li> </ul> </li> <li> <p>Usuario com login:</p> <ul> <li>Pode criar um pedido, que fica disponivel no carrinho de compras.</li> <li>Pode adicionar, remover e alterar os items do pedido a qualquer momento.</li> <li>Pode efetuar a compra os items desejados.</li> </ul> </li> <li> <p>Usuario admin:</p> <ul> <li>Tem acesso ao painel do admin, onde \u00e9 possivel controlar a cria\u00e7\u00e3o, altera\u00e7\u00e3o e exclus\u00e3o de produtos. Tamb\u00e9m possui acesso as informa\u00e7\u00f5es de todos os pedidos e os dados dos usuarios.</li> </ul> </li> </ul>"},{"location":"entidades/","title":"Relacionamento de Entidades","text":"<p>User \u2192 Order</p> <ul> <li>Um usu\u00e1rio pode realizar v\u00e1rios pedidos (1:N).</li> </ul> <p>Order \u2192 OrderItem</p> <ul> <li>Um pedido pode conter v\u00e1rios itens (1:N).</li> </ul> <p>OrderItem \u2192 Product</p> <ul> <li>Cada item do pedido refere-se a um \u00fanico produto (N:1).</li> </ul> <p>Veja abaixo:</p> <pre><code>erDiagram\n    User ||--o{ Order : places\n    Order ||--o{ OrderItem : contains\n    OrderItem }o--|| Product : refers_to\n\n    User {\n        int id PK\n        string email UK\n        string username\n        string password\n        bool is_admin\n        datetime created_at\n        datetime updated_at\n    }\n\n    Product {\n        int id PK\n        string name UK\n        string description\n        decimal price\n        int stock_quantity\n        bool is_active\n        string image\n        datetime created_at\n        datetime updated_at\n    }\n\n    Order {\n        int id PK\n        int user_id FK\n        decimal total_amount\n        string status\n        datetime created_at\n        datetime updated_at\n    }\n\n    OrderItem {\n        int id PK\n        int order_id FK\n        int product_id FK\n        int quantity\n        decimal price\n        string product_name\n        string product_image\n    }</code></pre>"},{"location":"fluxo/","title":"Fluxo de utiliza\u00e7\u00e3o","text":"<p>O usuario final tem acesso ao Sabores da terra de duas formas distintas:</p> <ul> <li> <p>Atraves da pagina web, onde possui os principais recursos como cria\u00e7\u00e3o de conta, visualiza\u00e7\u00e3o do produtos, o carrinho de compras e o por fim a efetiva\u00e7\u00e3o do pagamento.</p> </li> <li> <p>Bot do telegram, onde \u00e9 possivel visualizar os pre\u00e7os, o estoque, e a imagem do produto \u00e1 venda em tempo real, alem de ter acesso ao link de redirecionamento da pagina web e da rede social.</p> </li> </ul> <p>O admin possui um painel administrativo, onde \u00e9 possivel cadastrar vendas manuais, sendo assim o sistema centraliza todas as vendas realizadas.</p> <p>Quando o usuario decidir realizar a compra, o checkout \u00e9 acionado, e um link para um sistema de pagamentos externo com todos os items do pedido \u00e9 criado, e o usuario \u00e9 redirecionado.</p> <p>Quando o pedido for pago, o sistema de pagamento envia um webhook para o sistema, ent\u00e3o o status \u00e9 definido como pago e um email \u00e9 enviado ao admin como aviso.</p> <p>Veja abaixo o Diagrama do uso do software pelo cliente:</p> <pre><code>graph TD\n    A(Cliente)\n    A --&gt; B[Pagina Web]\n    A --&gt; C[Telegram Bot]\n\n    subgraph app[APP]\n\n        app1[CRUD]\n        app2[Sistema de Vendas]\n        app3[Painel do admin]\n\n    end\n    app4[Sistema de Notifica\u00e7\u00e3o]\n\n    B --&gt; app\n    C --&gt; app\n    D[Venda manual] --&gt; app3\n\n    app2 --&gt; app4\n\n    app2 --&gt; |checkout| F(Sistema de Pagamentos Externo)\n    F --&gt; |Webhook|app2\n\n    app1 --&gt; E[(database)]\n    app2 --&gt; E\n    app3 --&gt; E</code></pre>"},{"location":"get_started/","title":"Pre-requisitos","text":"<ul> <li>Python 3.12: Para instalar o python acesse o site oficial clicando aqui.</li> <li>Docker: Acesse a documenta\u00e7\u00e3o oficial do docker para a insta\u00e7\u00e3o clicando aqui.</li> </ul>"},{"location":"get_started/#configurando-ambiente","title":"Configurando ambiente","text":"<p>Abra o terminal na pasta desejada e siga os passos abaixo:</p> <pre><code>git clone https://github.com/guilopes15/sabores-da-terra.git\n\ncd sabores-da-terra\n\npip install pipx\n\npipx ensurepath\n\npipx install poetry\n\npoetry env use 3.12\n\npoetry install\n</code></pre>"},{"location":"get_started/#variaveis-de-ambiente","title":"Variaveis de ambiente","text":"<p>Crie um arquivo .env na raiz do projeto (no mesmo nivel do pyproject.toml) com as seguintes variaveis.</p> <p><pre><code>DATABASE_URL='postgresql+asyncpg://app_user:app_password@localhost:5432/app_db'\nSECRET_KEY='sua-chave-secreta'\nALGORITHM='HS256'\nACCESS_TOKEN_EXPIRE_MINUTES=30\nSTRIPE_API_KEY='chave-de-api-stripe'\nWEBHOOK_SECRET='webhook-secret'\nADMIN_SECRET='admin-secret'\nTELEGRAM_API_ID=seu-api-id\nTELEGRAM_API_HASH=\"seu-api-hash\"\nTELEGRAM_BOT_TOKEN=\"seu-bot-token\"\nSMTP_PASSWORD=\"seu-smtp=password\"\nEMAIL_SENDER=\"email-que-vai-mandar-a-notifica\u00e7\u00e3o\"\nEMAIL_RECIPIENT=\"email-que-vai-receber-a-notifica\u00e7\u00e3o\"\n</code></pre> Veja abaixo os tipos das variaveis para n\u00e3o errar nada.</p> <pre><code>from pydantic_settings import BaseSettings, SettingsConfigDict\n\n\nclass Settings(BaseSettings):\n    model_config = SettingsConfigDict(\n        env_file='.env', env_file_encoding='utf-8'\n    )\n\n    DATABASE_URL: str\n    SECRET_KEY: str\n    ALGORITHM: str\n    ACCESS_TOKEN_EXPIRE_MINUTES: int\n    STRIPE_API_KEY: str\n    WEBHOOK_SECRET: str\n    ADMIN_SECRET: str\n    TELEGRAM_API_ID: int\n    TELEGRAM_API_HASH: str\n    TELEGRAM_BOT_TOKEN: str\n    EMAIL_SENDER: str\n    EMAIL_RECIPIENT: str\n    SMTP_PASSWORD: str\n</code></pre> <p>Acesse o dashboard stripe e crie sua conta para obter a STRIPE_API_KEY e o WEBHOOK_SECRET clicando aqui.</p> <p>Acesse o telegram app configuration para obter o TELEGRAM_API_ID e o TELEGRAM_API_HASH clicando aqui.</p> <p>Converse com o @BotFather no seu proprio app do telegram e crie seu proprio bot para obter o TELEGRAM_BOT_TOKEN.</p> <p>Acesse o gmail, por exemplo, para obter o SMTP_PASSWORD clicando aqui.</p>"},{"location":"get_started/#subindo-o-server-localmente","title":"Subindo o server localmente","text":"<p>Com os passos anteriores feitos com sucesso, digite no terminal o seguinte comando:</p> <pre><code>docker compose up --build\n</code></pre> <p>Com isso o app j\u00e1 esta no ar em: http://localhost/</p>"},{"location":"infra/","title":"Infra","text":""},{"location":"infra/#configuracoes-de-build","title":"Configura\u00e7\u00f5es de Build","text":"<p>O projeto usa containers para isolar o app do restante do sistema.</p> <ul> <li>O arquivo Dockerfile possui as configura\u00e7\u00f5es e os comandos necess\u00e1rios para a cria\u00e7\u00e3o da imagem.</li> <li>Foi utilizado o recurso de multistage build para reduzir o tamanho da imagem de 800MB para 300MB.</li> </ul> <pre><code>FROM python:3.12-slim AS builder\n\nENV POETRY_VIRTUALENVS_CREATE=false\n\nRUN apt-get update\nRUN apt-get install -y build-essential gcc libssl-dev libffi-dev python3-dev\n\nWORKDIR /app\n\nCOPY pyproject.toml poetry.lock README.md ./\nRUN pip install poetry\n\nRUN poetry config installer.max-workers 10\n\nRUN poetry install --no-interaction --no-ansi --without dev --no-root\n\n\nCOPY . .\n\nFROM python:3.12-slim AS runtime\n\nENV POETRY_VIRTUALENVS_CREATE=false\nENV PYTHONPATH=/app/src\n\nWORKDIR /app\n\nCOPY --from=builder /usr/local/lib/python3.12 /usr/local/lib/python3.12\nCOPY --from=builder /usr/local/bin /usr/local/bin\nCOPY --from=builder /app /app\n\nEXPOSE 8000\nCMD [\"sh\", \"-c\", \"\\\n    uvicorn src.sabores_da_terra.app:app --host 0.0.0.0 --workers 2 &amp; \\\n    python src/sabores_da_terra_bot/main.py \\\n\"]\n</code></pre>"},{"location":"infra/#gerencimento-de-containers","title":"Gerencimento de Containers","text":"<p>O projeto possui 4 containers ao todo, o arquivo compose.yaml gerencia e define como os container v\u00e3o ser criados e como ir\u00e3o se comportar.</p> <ul> <li>sabores_da_terra_app: O principal container do projeto, respons\u00e1vel por executar tanto a API quanto o Bot. E possui uma r\u00e9plica adicional para permitir o load balance e maior disponibilidade do servi\u00e7o.</li> <li>sabores_da_terra_database: O Postgres foi defindo como o banco de dados do projeto, juntamente com um driver async.</li> <li>nginx: Um load balance e ao mesmo tempo um proxy reverso, usado para alternar a carga de requisi\u00e7\u00f5es igualmente entre as duas copias do app. Foi adicionado um rate limit de 10 reqs/s para amenizar possiveis ataques Ddos.</li> </ul> <pre><code>services:\n  sabores_da_terra_database:\n    image: postgres:17\n    environment:\n      POSTGRES_USER: app_user\n      POSTGRES_DB: app_db\n      POSTGRES_PASSWORD: app_password\n    command: postgres -c 'max_connections=500'\n    ports:\n      - \"5432:5432\"\n    volumes:\n      - pgdata:/var/lib/postgresql/data\n    deploy:\n      resources:\n        limits:\n          cpus: '0.3'\n          memory: '1GB'\n\n  sabores_da_terra_app1: &amp;sabores_da_terra\n    image: sabores_da_terra\n    build: .\n    entrypoint: ./entrypoint.sh\n    depends_on:\n      - sabores_da_terra_database\n    environment:\n      DATABASE_URL: postgresql+asyncpg://app_user:app_password@sabores_da_terra_database:5432/app_db\n    deploy:\n      resources:\n        limits:\n          cpus: '0.3'\n          memory: '0.4GB'\n\n  sabores_da_terra_app2:\n    &lt;&lt;: *sabores_da_terra\n\n  nginx:\n    image: nginx:alpine\n    container_name: sabores_nginx\n    ports:\n      - \"80:80\"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf:ro\n    depends_on:\n      - sabores_da_terra_app1\n      - sabores_da_terra_app2\n    ulimits:\n      nproc: 1000000\n      nofile:\n        soft: 1000000\n        hard: 1000000\n    deploy:\n      resources:\n        limits:\n          cpus: '0.1'\n          memory: '0.2GB'\n\nvolumes:\n  pgdata:\n</code></pre>"},{"location":"infra/#gerenciamneto-de-recursos","title":"Gerenciamneto de recursos","text":"<p>O projeto tem um gerenciamento de recursos de hardware minuncioso, e utiliza ao todo 1cpu e 2gb de memoria.</p> <ul> <li>Cada container do sabores_da_terra_app possui 2 workers, consumindo em m\u00e9dia 340MB.</li> <li>O banco de dados tem a maior parte da memoria disponivel para maior disponibilidade.</li> </ul>"},{"location":"infra/#teste-de-carga-e-performace","title":"Teste de carga e Performace","text":"<p>Foi utilizado o siege para executar o teste de carga.</p> <ul> <li>O Teste foi feito usando apenas 1 rota de GET (leitura).</li> <li>Leve em considera\u00e7\u00e3o que o teste foi feito em um ambiente wsl, com 1cpu e 2gb de memoria e sem cache.</li> </ul> <p>Mesmo com as limita\u00e7\u00f5es acima, o app consegui manter 450 usuarios simultaneos, com 100% de disponilidade e 0 falhas de requests.</p> <p>Veja o resultado abaixo:</p> <p></p>"},{"location":"rules/","title":"Regras de Neg\u00f3cio","text":"<p>Os controllers, models e event listeners definem todas as regras de neg\u00f3cio do projeto.</p>"},{"location":"rules/#models","title":"Models","text":"<p>Refletem a estrutura do banco de dados a partir de classes.</p>"},{"location":"rules/#users","title":"Users","text":"<ul> <li>Deve possuir email \u00fanico, para diferenciar cada usu\u00e1rio.</li> <li>Possui um campo booleano <code>is_admin</code>, para gerenciar permiss\u00f5es.</li> <li>Carrega todos os seus pedidos, conectado em forma de relacionamento com o model <code>Order</code>.</li> <li>Um usu\u00e1rio pode ter v\u00e1rios pedidos.</li> </ul>"},{"location":"rules/#products","title":"Products","text":"<ul> <li>Possui nome \u00fanico, para se diferenciar dos outros produtos.</li> <li>Possui o campo booleano <code>is_active</code>, que atua como um soft delete.</li> <li>\u00c9 poss\u00edvel definir uma imagem para o produto (opcional); caso n\u00e3o adicione, uma imagem placeholder \u00e9 utilizada.</li> <li>Possui constraints personalizadas:<ul> <li><code>stock</code> deve ser &gt;= 0</li> <li><code>pre\u00e7o</code> deve ser &gt; 0</li> </ul> </li> </ul>"},{"location":"rules/#order","title":"Order","text":"<ul> <li>Possui um campo <code>user_id</code> como chave estrangeira, indicando qual usu\u00e1rio criou o pedido.</li> <li>Possui uma constraint personalizada: <code>total_amount</code> precisa ser &gt;= 0.</li> <li>O campo <code>status</code> atua como um enum, restringindo o status a tr\u00eas categorias.</li> <li>O pedido pode ter v\u00e1rios itens.</li> <li>Deve possuir todos os dados dos itens do pedido, conectado em relacionamento com <code>OrderItems</code>.</li> </ul>"},{"location":"rules/#orderitems","title":"OrderItems","text":"<ul> <li>Possui um campo <code>order_id</code> como chave estrangeira, indicando a qual order o item pertence.</li> <li>Possui um campo <code>product_id</code> como chave estrangeira, indicando a qual product o item se refere.</li> <li>Possui uma constraint personalizada: <code>quantity</code> deve ser &gt;= 0.</li> <li>Possui um campo opcional <code>product_image</code>.</li> <li>Possui relacionamento com <code>Products</code>.</li> </ul>"},{"location":"rules/#controllers","title":"Controllers","text":"<p>S\u00e3o classes que agrupam m\u00e9todos e definem o comportamento de cada rota de acordo com o verbo HTTP. Contemplam a session, o schema e as permiss\u00f5es, executam verifica\u00e7\u00f5es/valida\u00e7\u00f5es e persistem os dados no banco.</p>"},{"location":"rules/#user-controller","title":"User Controller","text":"<ul> <li> <p>create</p> <ul> <li>Possui um par\u00e2metro opcional <code>admin_secret</code>.</li> <li>Busca no banco se existe um usu\u00e1rio com o mesmo email.</li> <li>Verifica o <code>admin_secret</code> com uma vari\u00e1vel de ambiente.</li> <li>Comp\u00f5e o model <code>User</code> com os dados do schema:<ul> <li>Se a verifica\u00e7\u00e3o for verdadeira, \u00e9 criado um admin.</li> <li>Se for falsa, \u00e9 criado um user comum.</li> </ul> </li> <li>Persiste no banco e retorna os dados.</li> </ul> </li> <li> <p>read_all</p> <ul> <li>Busca no banco e retorna todos os usu\u00e1rios cadastrados.</li> </ul> </li> <li> <p>read_by_id</p> <ul> <li>Busca um usu\u00e1rio pelo <code>id</code>; se encontrado, retorna, sen\u00e3o retorna erro.</li> </ul> </li> <li> <p>update</p> <ul> <li>Se n\u00e3o estiver logado ou o <code>id</code> n\u00e3o for o do usu\u00e1rio logado, retorna erro.</li> <li>Altera os dados do usu\u00e1rio e faz commit.</li> <li>Se o email j\u00e1 existir, retorna <code>IntegrityError</code>.</li> </ul> </li> <li> <p>delete</p> <ul> <li>Se n\u00e3o estiver logado ou o <code>id</code> n\u00e3o for o do usu\u00e1rio logado, retorna erro.</li> <li>Deleta o usu\u00e1rio do banco e o cookie.</li> </ul> </li> </ul>"},{"location":"rules/#product-controller","title":"Product Controller","text":"<ul> <li> <p>create</p> <ul> <li>Verifica se o produto j\u00e1 existe; se existir, retorna erro.</li> <li>Preenche o model com os dados e persiste.</li> <li>Retorna os dados do produto.</li> </ul> </li> <li> <p>read_all</p> <ul> <li>Retorna todos os produtos cadastrados.</li> </ul> </li> <li> <p>read_by_id</p> <ul> <li>Busca um produto pelo <code>id</code>; se encontrado, retorna, sen\u00e3o retorna erro.</li> </ul> </li> <li> <p>pagination</p> <ul> <li>Filtra produtos pelo nome.</li> <li>Limita a quantidade de produtos retornados.</li> <li>Define o offset de in\u00edcio da busca.</li> </ul> </li> <li> <p>patch</p> <ul> <li>Busca o produto pelo <code>id</code>; se n\u00e3o encontrar, retorna erro.</li> <li>Altera os dados do produto e persiste.</li> <li>Se o nome do produto j\u00e1 existir, retorna erro.</li> </ul> </li> <li> <p>delete</p> <ul> <li>Busca o produto pelo <code>id</code>; se n\u00e3o encontrar, retorna erro.</li> <li>Altera o campo <code>is_active</code> para <code>false</code> e persiste.</li> </ul> </li> </ul>"},{"location":"rules/#order-controller","title":"Order Controller","text":"<ul> <li> <p>create</p> <ul> <li>Requer login; se n\u00e3o, retorna erro.</li> <li>Se o usu\u00e1rio j\u00e1 tiver uma order pendente, retorna a order.</li> <li>Cria a order com os dados iniciais, sem itens.</li> <li>Verifica os produtos da order:<ul> <li>Se existem</li> <li>Se est\u00e3o ativos</li> <li>Se h\u00e1 estoque suficiente</li> </ul> </li> <li>Se a verifica\u00e7\u00e3o falhar, retorna erro.</li> <li>Se a quantidade do produto for &gt; 0, adiciona na order.</li> <li>Persiste os dados e retorna a order.</li> </ul> </li> <li> <p>read</p> <ul> <li>Requer login; se n\u00e3o, retorna erro.</li> <li>Busca a order pendente do usu\u00e1rio logado; se existir, retorna, sen\u00e3o retorna erro.</li> </ul> </li> <li> <p>read_by_id</p> <ul> <li>Busca uma order pelo <code>id</code>; se existir, retorna, sen\u00e3o retorna erro.</li> </ul> </li> <li> <p>update</p> <ul> <li>Requer login; se n\u00e3o, retorna erro.</li> <li>Busca a order pendente do usu\u00e1rio logado; se n\u00e3o existir, retorna erro.</li> <li>Valida o produto a ser modificado:<ul> <li>Existe?</li> <li>Est\u00e1 ativo?</li> <li>H\u00e1 estoque suficiente?</li> </ul> </li> <li>Verifica se o produto j\u00e1 est\u00e1 na order; se n\u00e3o, adiciona.<ul> <li>Se a quantidade do produto for &gt; 0, atualiza quantidade e pre\u00e7o.</li> <li>Se for 0, remove o produto da order.</li> </ul> </li> <li>Atualiza o total a pagar da order e persiste.</li> </ul> </li> <li> <p>delete</p> <ul> <li>Requer login; se n\u00e3o, retorna erro.</li> <li>Busca uma order pelo <code>id</code>; se existir, deleta, sen\u00e3o retorna erro.</li> </ul> </li> </ul>"},{"location":"rules/#payment-controller","title":"Payment Controller","text":"<ul> <li> <p>checkout</p> <ul> <li>Requer login; se n\u00e3o, retorna erro.</li> <li>Busca a order pendente do usu\u00e1rio com <code>total_amount &gt; 0</code>.<ul> <li>Se n\u00e3o existir, retorna erro.</li> <li>Se existir, monta um objeto com todos os itens da order.</li> <li>Cria a p\u00e1gina de pagamento a partir do objeto e retorna o link de acesso.</li> </ul> </li> </ul> </li> <li> <p>webhook</p> <ul> <li>Recebe um POST do sistema de pagamento.</li> <li>Verifica se a assinatura \u00e9 v\u00e1lida:<ul> <li>Se n\u00e3o for, retorna erro.</li> <li>Se for v\u00e1lida, verifica o evento e o status do pagamento.</li> </ul> </li> <li>Busca a order pelo <code>id</code>:<ul> <li>Se n\u00e3o existir, envia um email ao admin informando.</li> <li>Se existir, define o status para <code>paid</code>:<ul> <li>Subtrai do estoque todos os itens da order paga.</li> <li>Envia um email ao admin com informa\u00e7\u00f5es da venda.</li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"rules/#event-listeners","title":"Event Listeners","text":"<p>S\u00e3o a\u00e7\u00f5es executadas quando certos eventos acontecem nos models, a partir da session.</p>"},{"location":"rules/#depois-que-um-produto-for-alterado","title":"Depois que um produto for alterado:","text":"<ul> <li>Quando um produto ficar inativo, ele deve ser removido de pedidos pendentes e o total deve ser atualizado.</li> <li>Quando o pre\u00e7o de um produto for alterado, o total de todos os pedidos que o possuem deve ser atualizado.</li> </ul>"},{"location":"routers/","title":"Vis\u00e3o Geral","text":"<p>Sabores da Terra possui rotas organizadas por funcionadlides e que seguem certos padr\u00f5es. Veja abaixo:</p>"},{"location":"routers/#url-base","title":"URL Base","text":"<pre><code>http://localhost/api\n</code></pre>"},{"location":"routers/#veja-a-documentacao-interativa","title":"Veja a Documenta\u00e7\u00e3o Interativa","text":"<ul> <li>Swagger: <code>http://localhost/docs</code></li> <li>Redoc: <code>http://localhost/redoc</code></li> <li>OpenAPI: <code>http://localhost/openapi.json</code></li> </ul>"},{"location":"routers/#common-responses","title":"Common Responses:","text":"<ul> <li>Os endpoints com login required ou admin permission required compartilham responses de error - 401 UNAUTHORIZED.</li> </ul> <pre><code>{\n  \"detail\": \"Could not validate credentials\"\n}\n</code></pre> <ul> <li>Todos os endpoints que possuem, Content-Type: application/json ou Content-Type: application/x-www-form-urlencoded ou que precisam passar o token jwt pelo header, compartilham responses de erro de quebra de contrato - 422 UNPROCESSABLE ENTITY.</li> </ul> <pre><code>{\n\n  \"detail\": [\n    {\n      \"loc\": [\n        \"string\",\n        0\n      ],\n      \"msg\": \"string\",\n      \"type\": \"string\"\n    }\n  ]\n}\n</code></pre>"},{"location":"routers/auth/","title":"Auth","text":"<p>POST <code>/api/auth/token</code> - Gera o token JWT</p> <p>Exemplo de uso com curl:</p> <pre><code>curl -X POST \"http://localhost/api/auth/token\" -H 'Content-Type: application/x-www-form-urlencoded' -d \"username=test%40test.com&amp;password=123456\"\n</code></pre> <p>Response 200 - OK: <pre><code>{\n  \"access_token\":\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0QHRlc3QuY29tIiwiZXhwIjoxNzY1Mjk3NTE3fQ.rKIJYxrcyTI3jBhZPvI5jMclyFLM8f8_RZ5P6nz-tVI\",\n  \"token_type\": \"bearer\"\n}\n</code></pre> Response 400 - BAD_REQUEST:</p> <pre><code>{\n\"detail\": \"Incorrect email or password\"\n}\n</code></pre> <p>POST <code>/api/auth/refresh_token</code> - Extende o tempo de uso do usuario autenticado - login required</p> <p>Exemplo de uso com curl:</p> <p><pre><code>curl -X POST \"http://localhost/api/auth/refresh_token\" -H \"Authorization\": \"bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0QHRlc3QuY29tIiwiZXhwIjoxNzY1Mjk3NTE3fQ.rKIJYxrcyTI3jBhZPvI5jMclyFLM8f8_RZ5P6nz-tVI \"\n</code></pre> Response 200 - OK:</p> <pre><code>{\n \"access_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0QHRlc3QuY29tIiwiZXhwIjoxNzY1Mjk4NTQ4fQ.PALsRe1IcjLQjn_gkuPkdDJvTtx0bwzuo6epu8hZhMQ\",\n \"token_type\": \"bearer\"\n}\n</code></pre>"},{"location":"routers/orders/","title":"Orders","text":"<p>POST <code>/api/orders/</code> - Cria uma order de venda - login required</p> <p>Todas as orders s\u00e3o criadas com o status pending por default, mas o status pode ser passado via json. Cada user so pode ir uma order(pedido) pendente por vez, para criar um novo pedido \u00e9 necessario pagar ou excluir o pedido atual.</p> <p>Exemplo de uso com curl:</p> <pre><code>curl -X POST \"'http://localhost/api/orders/\" -H \"Content-Type: application/json\" -d {\"status\": \"pending\", \"items\": [{\"produc_id\": 1, \"quantity:1\"}]}\n</code></pre> <p>Resquest Body:</p> <pre><code>{\n  \"status\": \"pending\" or \"paid\" or \"canceled\",\n  \"items\": [\n    {\n      \"product_id\": 1,\n      \"quantity\": 1\n    }\n  ]\n}\n</code></pre> <p>Response 200 - OK:</p> <pre><code>{\n  \"id\": 1,\n  \"user_id\": 1,\n  \"total_amount\": \"5.5\",\n  \"status\": \"pending\",\n  \"created_at\": \"2025-12-08T21:59:55.992123\",\n  \"updated_at\": \"2025-12-08T21:59:55.992123\",\n  \"items\": [\n    {\n      \"id\": 1,\n      \"order_id\": 1,\n      \"product_id\": 1,\n      \"quantity\": 1,\n      \"price\": \"5.5\",\n      \"product_name\": \"Manga\",\n      \"product_image\": \"https://i.ibb.co/kVxk8QPN/manga.jpg\"\n    }\n  ]\n}\n</code></pre> <p>Response 404 - NOT FOUND: <pre><code>{\n  \"detail\": \"Product {item.product_id} not found.\"\n}\n</code></pre> Response 400 - BAD REQUEST:</p> <pre><code>{\n \"detail\": \"insufficient stock for product {item.product_id}\"\n}\n</code></pre> <p>GET <code>/api/orders/my-orders</code> - Busca a order que quem esta logado - login required</p> <p>Exemplo de uso com curl:</p> <p><pre><code>curl -X GET \"http://localhost/api/orders/my-orders\"\n</code></pre> Response 200 - OK:</p> <pre><code>{\n  \"id\": 1,\n  \"user_id\": 1,\n  \"total_amount\": \"30\",\n  \"status\": \"pending\",\n  \"created_at\": \"2025-11-30T21:37:55.957840\",\n  \"updated_at\": \"2025-12-06T15:05:18.982063\",\n  \"items\": [\n    {\n      \"id\": 1,\n      \"order_id\": 1,\n      \"product_id\": 6,\n      \"quantity\": 1,\n      \"price\": \"20\",\n      \"product_name\": \"manga\",\n      \"product_image\": null\n    },\n    {\n      \"id\": 2,\n      \"order_id\": 1,\n      \"product_id\": 5,\n      \"quantity\": 1,\n      \"price\": \"10\",\n      \"product_name\": \"Laranja Bahia\",\n      \"product_image\": \"https://i.ibb.co/kVxk8QPN/laranja-bahia.jpg\"\n    }\n  ]\n}\n</code></pre> <p>Response 404 - NOT FOUND:</p> <pre><code>{\n  \"detail\": \"Order does not exists or not pending.\"\n}\n</code></pre> <p>GET <code>/api/orders/{order_id}</code> - Busca uma order por ID - admin permission required</p> <p>Exemplo de uso com curl:</p> <p><pre><code>curl -X GET \"http://localhost/api/orders/1\"\n</code></pre> Response 200 - OK:</p> <p><pre><code>{\n  \"id\": 1,\n  \"user_id\": 1,\n  \"total_amount\": \"30\",\n  \"status\": \"pending\",\n  \"created_at\": \"2025-11-30T21:37:55.957840\",\n  \"updated_at\": \"2025-12-06T15:05:18.982063\",\n  \"items\": [\n    {\n      \"id\": 1,\n      \"order_id\": 1,\n      \"product_id\": 6,\n      \"quantity\": 1,\n      \"price\": \"20\",\n      \"product_name\": \"manga\",\n      \"product_image\": null\n    },\n    {\n      \"id\": 2,\n      \"order_id\": 1,\n      \"product_id\": 5,\n      \"quantity\": 1,\n      \"price\": \"10\",\n      \"product_name\": \"Laranja Bahia\",\n      \"product_image\": \"https://i.ibb.co/kVxk8QPN/laranja-bahia.jpg\"\n    }\n  ]\n}\n</code></pre> Response 404 - NOT FOUND:</p> <pre><code>{\n  \"detail\": \"Order does not exists.\"\n}\n</code></pre> <p>PUT <code>/api/orders/my-orders</code> - Atualiza os items da order - login required</p> <p>Exemplo de uso com curl:</p> <p><pre><code>curl -X \"http://localhost/api/orders/my-orders\" -H -H \"Content-Type: application/json\" -d {\"status\": \"pending\", \"items\": [{\"product_id\": 1, \"quantity\": 3}]}\n</code></pre> Request body:</p> <pre><code>{\n  \"status\": \"pending\" or \"paid\" or \"canceled\",\n  \"items\": [\n    {\n      \"product_id\": 1,\n      \"quantity\": 3\n    }\n  ]\n}\n</code></pre> <p>Response 200 - OK:</p> <pre><code>{\n  \"id\": 1,\n  \"user_id\": 1,\n  \"total_amount\": \"70\",\n  \"status\": \"pending\",\n  \"created_at\": \"2025-11-30T21:37:55.957840\",\n  \"updated_at\": \"2025-12-06T15:05:18.982063\",\n  \"items\": [\n    {\n      \"id\": 1,\n      \"order_id\": 1,\n      \"product_id\": 6,\n      \"quantity\": 3,\n      \"price\": \"20\",\n      \"product_name\": \"manga\",\n      \"product_image\": null\n    },\n    {\n      \"id\": 2,\n      \"order_id\": 1,\n      \"product_id\": 5,\n      \"quantity\": 1,\n      \"price\": \"10\",\n      \"product_name\": \"Laranja Bahia\",\n      \"product_image\": \"https://i.ibb.co/kVxk8QPN/laranja-bahia.jpg\"\n    }\n  ]\n}\n</code></pre> <p>Response 404 - NOT FOUND:</p> <pre><code>{\n  \"detail\": \"Order does not exists or not pending.\"\n}\n</code></pre> <p>OU</p> <pre><code>{\n  \"detail\": \"Product {item.product_id} not found.\"\n}\n</code></pre> <p>Response 400 - BAD REQUEST:</p> <pre><code>{\n  \"detail\": \"insufficient stock for product_id {item.product_id}\"\n}\n</code></pre> <p>DELETE <code>/api/orders/my-orders</code> - Deleta a order que quem esta logado - login required</p> <p>Exemplo de uso com curl:</p> <pre><code>curl -X DELETE \"http://localhost/api/orders/my-orders\"\n</code></pre> <p>Response 200 - OK:</p> <pre><code>{\n  \"message\": \"Order deleted.\"\n}\n</code></pre> <p>Response 404 - NOT FOUND:</p> <pre><code>{\n  \"detail\": \"Order does not exists or not pending.\"\n}\n</code></pre>"},{"location":"routers/payment/","title":"Payment","text":"<p>POST <code>/api/payment/checkout/{order_id}</code> - Gera uma url para o sistema de pagamento externo. login required</p> <p>Exemplo de uso com curl:</p> <pre><code>curl -X POST \"http://localhost/api/payment/checkout/1\"\n</code></pre> <p>Response 200 - OK:</p> <pre><code>{\n  \"checkout_url\": \"https://example.com/\"\n}\n</code></pre> <p>Response 404 - NOT_FOUND: <pre><code>{\n  \"detail\": \"Invalid Order.\"\n}\n</code></pre></p> <p>POST <code>/api/payment/webhook</code> - Recebe um request quando um pagamento for realizado</p> <p>Response 200 - OK:</p> <pre><code>{\n  \"message\": \"Order processed successfully.\"\n}\n</code></pre> <p>Response 401 - UNAUTHORIZED:</p> <p>Assinatura invalida (request que n\u00e3o veio do sistema de pagamento).</p> <p><pre><code>{\n  \"message\": \"Invalid signature\"\n}\n</code></pre> Response 200 - OK:</p> <p>Payment_status diferente de paid:</p> <pre><code>{\n  \"message\": \"No orders processed.\"\n}\n</code></pre> <p>Obs: quando nehuma order for encontrada um email \u00e9 enviado ao admin do sistema.</p>"},{"location":"routers/products/","title":"Products","text":"<p>POST <code>/api/products/</code> - Criar produto - admin permission required</p> <p>Exemplo de uso com curl:</p> <pre><code>curl -X POST \"http://localhost/api/products/\" -H \"Content-Type: application/json\" -d { \"name\": \"manga\", \"description\": \"manga organica\", \"price\": \"5.5\", \"stock_quantity\": 25, \"image\": \"https://i.ibb.co/kVxk8QPN/manga.jpg\" }\n</code></pre> <p>Request Body:</p> <pre><code>{\n  \"name\": \"manga\",\n  \"description\": \"manga organica\",\n  \"price\": \"5.5\",\n  \"stock_quantity\": 20,\n  \"image\": \"https://i.ibb.co/kVxk8QPN/manga.jpg\"\n}\n</code></pre> <p>Response 200 - OK:</p> <pre><code>{\n  \"name\": \"manga\",\n  \"description\": \"manga organica\",\n  \"price\": \"5.5\",\n  \"stock_quantity\": 20,\n  \"image\": \"https://i.ibb.co/kVxk8QPN/manga.jpg\",\n  \"id\": 1,\n  \"is_active\": true,\n  \"created_at\": \"2025-10-10T15:04:10.328736\",\n  \"updated_at\": \"2025-10-10T17:05:32.428075\"\n}\n</code></pre> <p>Response 409 - CONFLICT:</p> <pre><code>{\n  \"detail\": \"Product already exists.\"\n}\n</code></pre> <p>GET <code>/api/products/</code> - Busca todos os produtos</p> <p>Exemplo de uso com curl:</p> <pre><code>curl -X GET \"http://localhost/api/products/\"\n</code></pre> <p>Response 200 - OK:</p> <pre><code>{\n  \"products\": [\n      {\n        \"name\": \"uva\",\n        \"description\": \"Uva Organica\",\n        \"price\": \"25.5\",\n        \"stock_quantity\": 20,\n        \"image\": null,\n        \"id\": 2,\n        \"is_active\": false,\n        \"created_at\": \"2025-10-10T15:04:10.328736\",\n        \"updated_at\": \"2025-10-10T17:05:32.428075\"\n      },\n      {\n        \"name\": \"manga\",\n        \"description\": \"manga organica\",\n        \"price\": \"5.5\",\n        \"stock_quantity\": 20,\n        \"image\": \"https://i.ibb.co/kVxk8QPN/manga.jpg\",\n        \"id\": 1,\n        \"is_active\": true,\n        \"created_at\": \"2025-10-10T15:04:10.328736\",\n        \"updated_at\": \"2025-10-10T17:05:32.428075\"\n      }\n  ]\n}\n</code></pre> <p>GET <code>/api/products/{product_id}</code> - Busca produtos por ID</p> <p>Exemplo de uso com curl:</p> <pre><code>curl -X GET http://localhost/api/products/1\n</code></pre> <p>Response 200 - OK: <pre><code>\"name\": \"manga\",\n\"description\": \"manga organica\",\n\"price\": \"5.5\",\n\"stock_quantity\": 20,\n\"image\": \"https://i.ibb.co/kVxk8QPN/manga.jpg\",\n\"id\": 1,\n\"is_active\": true,\n\"created_at\": \"2025-10-10T15:04:10.328736\",\n\"updated_at\": \"2025-10-10T17:05:32.428075\"\n</code></pre></p> <p>Response 404 - NOT FOUND:</p> <pre><code>{\n  \"detail\": \"Product does not exists.\"\n}\n</code></pre> <p>GET <code>/api/products/filters</code> - Busca produtos por queryparams</p> <p>Queryparams:</p> <ul> <li>name: str or null =  Busca os produto pelo nome desejado</li> <li>offset: int = Por onde come\u00e7a a busca, default \u00e9 0.</li> <li>limit: int = quantidade de items m\u00e1xima retornada, default \u00e9 10.</li> </ul> <p>Exemplo de uso com curl:</p> <p><pre><code>curl -X GET \"http://localhost/api/products/filters?name=manga&amp;offset=0&amp;limit=10\"\n</code></pre> Response 200 - OK:</p> <pre><code>\"products\": [\n  {\n    \"name\": \"Manga\",\n    \"description\": \"manga organica\",\n    \"price\": \"5.5\",\n    \"stock_quantity\": 20,\n    \"image\": \"https://i.ibb.co/3qxw4J7/manga-palmer-2ys6v2qa3v-1.png\",\n    \"id\": 1,\n    \"is_active\": true,\n    \"created_at\": \"2025-10-17T14:46:29.369435\",\n    \"updated_at\": \"2025-12-06T14:06:14.252931\"\n  }\n]\n</code></pre> <p>PATCH <code>/api/products/{product_id}</code> - Atualiza as informa\u00e7\u00f5es dos produtos sob demanda - admin permission required</p> <p>Obs: Todas os campos do request body s\u00e3o opcionais.</p> <p>Exemplo de uso com curl: <pre><code>curl -X PATCH \"http://localhost/api/products/1\" -H \"Content-Type: application/json\" -d {\"name\"=\"Manga Tommy\"}\n</code></pre> Request Body:</p> <pre><code>{\n  \"name\": \"string\",\n  \"price\": 1,\n  \"stock_quantity\": 20,\n  \"description\": \"string\",\n  \"image\": \"string\"\n}\n</code></pre> <p>Response 200 - OK: <pre><code>\"name\": \"Manga Tommy\",\n\"description\": \"manga organica\",\n\"price\": \"5.5\",\n\"stock_quantity\": 20,\n\"image\": \"https://i.ibb.co/3qxw4J7/manga-palmer-2ys6v2qa3v-1.png\",\n\"id\": 1,\n\"is_active\": true,\n\"created_at\": \"2025-10-17T14:46:29.369435\",\n\"updated_at\": \"2025-12-06T14:06:14.252931\"\n</code></pre></p> <p>Response 404 - NOT FOUND:</p> <pre><code>{\n  \"detail\": \"Product does not exists.\"\n}\n</code></pre> <p>Response 409 - CONFLICT: <pre><code>{\n  \"detail\": \"Product name already exists.\"\n}\n</code></pre></p> <p>DELETE <code>/api/products/{products_id}</code> - Deletar produto - admin permission required O delete faz um soft delete, apenas muda o is_active para false.</p> <p>Exemplo de uso com curl: <pre><code>curl -X \"http://localhost/api/products/1\"\n</code></pre> Response 200 - OK:</p> <p><pre><code>{\n  \"message\": \"Product deleted\"\n}\n</code></pre> Response 404 - NOT FOUND: <pre><code>{\n  \"detail\": \"Product does not exists.\"\n}\n</code></pre> Response 409 - CONFLICT:</p> <pre><code>{\n  \"detail\": \"cannot remove product\"\n}\n</code></pre>"},{"location":"routers/users/","title":"Users","text":"<p>POST <code>/api/users</code> - Usada para criar novo usuario comum</p> <p>Exemplo de uso com curl: <pre><code>curl -X \"POST http://localhost/api/users\" -H \"Content-Type: application/json\" -d '{\"username\":\"example\", \"email\": \"example@example.com\", \"password\": 123456}'\n</code></pre></p> <p>POST <code>/api/users</code> - Tambem usada para criar novo usuario admin</p> <p>Exemplo de uso com curl:</p> <pre><code>curl -X POST \"http://localhost/api/users\" -H \"Content-Type: application/json\" -H \"admin_secret\": \"admin-secret-key\" -d '{\"username\":\"example\", \"email\": \"example@example.com\", \"password\": 123456}'\n</code></pre> <p>Request Body: <pre><code>{\n  \"username\": \"example\"\n  \"email\": \"example@example.com\"\n  \"password\": 123456\n}\n</code></pre> Response 201 - CREATED:</p> <pre><code>{\n  \"id\": 1,\n  \"username\": \"example\",\n  \"email\": \"example@example.com\",\n  \"created_at\": \"2025-12-06T14:40:38.334Z\",\n  \"updated_at\": \"2025-12-06T14:40:38.334Z\",\n  \"is_admin\": \"false\",\n  \"orders\": []\n}\n</code></pre> <p>Response 409 - CONFLICT:</p> <pre><code>{\n  \"detail\": \"Email already exists.\"\n}\n</code></pre> <p>GET <code>/api/users/</code> - Busca todos os usuarios cadastrados no sistema</p> <p>Exemplo de uso com curl:</p> <pre><code>curl -X GET \"http://localhost/api/users\"\n</code></pre> <p>Response 200 - OK:</p> <pre><code>\"users\": [\n    {\n      \"id\": 1,\n      \"username\": \"example\",\n      \"email\": \"example@example.com\",\n      \"created_at\": \"2025-12-06T14:40:38.334Z\",\n      \"updated_at\": \"2025-12-06T14:40:38.334Z\",\n      \"is_admin\": true,\n      \"orders\": []\n\n\n    },\n\n    {\n      \"id\": 2,\n      \"username\": \"test\",\n      \"email\": \"test@example.com\",\n      \"created_at\": \"2025-12-06T14:40:38.334Z\",\n      \"updated_at\": \"2025-12-06T14:40:38.334Z\",\n      \"is_admin\": false,\n      \"orders\": []\n    }\n</code></pre> <p>GET <code>/api/users{user_id}</code> - Busca usuario por ID</p> <p>Exemplo de uso com curl: <pre><code>curl -X GET \"http://localhost/api/users/1\"\n</code></pre></p> <p>Response 200 - OK - Exemplo 1 :</p> <p><pre><code>{\n  \"id\": 1,\n  \"username\": \"example\",\n  \"email\": \"example@example.com\",\n  \"created_at\": \"2025-12-06T14:40:38.334Z\",\n  \"updated_at\": \"2025-12-06T14:40:38.334Z\",\n  \"is_admin\": true,\n  \"orders\": []\n}\n</code></pre> Response 200 - OK - Exemplo 2 (com orders):</p> <p><pre><code>{\n  \"id\": 1,\n  \"username\": \"example\",\n  \"email\": \"example@example.com\",\n  \"created_at\": \"2025-12-08T15:19:26.991Z\",\n  \"updated_at\": \"2025-12-08T15:19:26.992Z\",\n  \"is_admin\": true,\n  \"orders\": [\n    {\n      \"id\": 1,\n      \"user_id\": 1,\n      \"total_amount\": \"50.50\",\n      \"status\": \"pending\",\n      \"created_at\": \"2025-12-08T15:19:26.992Z\",\n      \"updated_at\": \"2025-12-08T15:19:26.992Z\",\n      \"items\": [\n        {\n          \"id\": 1,\n          \"order_id\": 1,\n          \"product_id\": 1,\n          \"quantity\": 2,\n          \"price\": \"25.25\",\n          \"product_name\": \"batata\",\n          \"product_image\": \"https://i.ibb.co/kVxk8QPN/batata.jpg\"\n        }\n      ]\n    }\n  ]\n}\n</code></pre> Response 404 - NOT FOUND:</p> <pre><code>{\n  \"detail\": \"User does not exists.\"\n}\n</code></pre> <p>PUT <code>/api/users/{user_id}</code> - Atualiza todas as informa\u00e7\u00f5es do usuario - login required</p> <p>Exemplo de uso com curl:</p> <pre><code>curl -X PUT \"http://localhost/api/users/1\" -H \"Content-Type: application/json\" -d {\"username\": \"string\", \"email\": \"string@example.com\", \"password\": \"654321\"}\n</code></pre> <p>Request Body:</p> <pre><code>{\n  \"username\": \"example\",\n  \"email\": \"example@example.com\",\n  \"password\": \"654321\"\n}\n</code></pre> <p>Response 200 - OK:</p> <p><pre><code>{\n  \"id\": 1,\n  \"username\": \"example\",\n  \"email\": \"example@example.com\",\n  \"created_at\": \"2025-12-06T15:12:40.304Z\",\n  \"updated_at\": \"2025-12-06T15:12:40.304Z\",\n  \"is_admin\": true,\n  \"orders\": []\n}\n</code></pre> Resquest 409 - CONFLICT:</p> <pre><code>{\n  \"detail\": \"Email already exists.\"\n}\n</code></pre> <p>Request 403 - FORBIDDEN: <pre><code>{\n  \"detail\": \"Not enough permission.\"\n}\n</code></pre></p> <p>DELETE <code>/api/users/{user_id}</code> - Deletar usuario - login required</p> <p>Exemplo com curl:</p> <p><pre><code>curl -X DELETE \"http://localhost/api/users/1\"\n</code></pre> Response 200 - OK:</p> <pre><code>{\n  \"message\": \"User deleted\"\n}\n</code></pre> <p>Response 403 - FORBIDDEN; <pre><code>{\n  \"detail\": \"Not enough permission.\"\n}\n</code></pre></p>"}]}